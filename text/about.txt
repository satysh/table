\documentclass[oneside, final, 14pt]{extreport}
\usepackage[utf8x]{inputenc}
\usepackage[russianb]{babel}
\usepackage{vmargin}
\usepackage{graphicx}
\usepackage{amsmath}
\setpapersize{A4}
\setmarginsrb{2cm}{1.5cm}{1cm}{1.5cm}{0pt}{0mm}{0pt}{13mm}
\usepackage{indentfirst}
\sloppy
\begin{document}

\chapter*{\large{Моделирование упругого рассеяния}}
К сожалению пакет \emph{geant} не имеет средств для моделирования упругих сооударений. Поэтому было предложенно промоделировать процесс упругого соударения налетающего иона с мишенью самостоятельно, а затем передать информацию о продуктах реакций пакету \emph{geant}  для дальнейшего моделирования взаимодейсвия с детекторами. Моделирование осуществлялось с помощью пакета \emph{expertroot}, на базе которого был создан дополнительный класс для упругих столкновени.

Идея следющая: в исходный код закладывается теоритическое сечение упругово столконвения \emph{азота 15} на\emph{ боре 11}. На оснований этого сечения разыгрывается угол вылета \emph{азота 15} после взаимодейсвия с мишенью, и далее вычисляется соответвующий угол вылета\emph{ бора 11}. Исходное сечение представляет из себя набор точек, на оснований которых строится, с помощью средств пакета \emph{rootcern}, экстраполяционная функция плотности вероятностей. Именно на оснований данной функций разыгрыватся угол вылета \emph{азота 15}. На практике это осущесвляется следующим образом. Функция плотности вероятностей позволяет для каждого возможного угла получить его вероятность. В силу этого, достаточно разыграть случайное число от 0 до 1 (в нутри данного диапозона вероятность быть выбраным для всех чисел одинакова), по значению полученного числа вычислить угол, которому соотвествует выпавшее число, путем инверсий функций плотности вероятностей. И так для каждого процесса соударения \emph{азота 15} с мишенью \emph{бором 11}. Данный метод посволяет так же задавать произвольный диапозон для розыгрыша углов после соударения. Естесвенно в таком случае выбирать диапозон углов таким, что бы все его значения попадали в диапозон углов, которые регистрирует детектор. Так же это позволяет нам приблизить модель к реальному эксперименту. Это значит что для одного положения детектора мы можем в одном запуске события регистрировать как \emph{азот 15}, так и \emph{бор 11}. Осущесвить это можно выбрав два диапозона углов, которые регистрируются для заданного положения детектора: отдельно для \emph{азота 15}, и отдельно для \emph{бора 11}. Затем, вычислив соответвующие границам диапозонов значения функций плотности вероятностей, сложить длины полученных диапозонов функций плотности вероятностей и разыграть случайное число внутри этой суммарной длины. Далле, полученное случайное число позволяет, путем инверсий функций плотности вероятностей, вычислить случайный угол вылета и в зависимости от того в какую часть он попал (азота 15 или бора 11) идентифицировать вылетевший ион. Так мы сущесвенно снижаем число событий, которое необходимо запустить для набора статистики с учетом не полной регистраций ионов на границах регистрирующей области детектора.

Процесс упругого соударения удобнее рассматривать в системе центра масс. С другой стороны геометрию эксперимента: колиматор, мишень и детектор, удобнее построить в лабороторной системе координат. Из этого следует, что необходимо  знать формулы, по которым можно установить связь между углами в системе центра масс и лабороторной системы.

\begin{figure}[t]
 \centering
 \includegraphics[width=0.9\textwidth]{resultGr}
 \caption{Теоритическое сечение упругого рассеяния и результаты моделирования упругогорассеяния \emph{азота 15} на \emph{боре 11} для различных углов \(\theta_\text{ц.м}\). }
 \label{res:graph}
\end{figure}

Формула связывающая \(\theta_1\text{ц.м}\) и угол \(\theta_1\):
\begin{equation}
\theta_1\text{ц.м} = \arccos\Bigl(-\frac{M_\text{1}}{M_\text{2}} \sin^2 \theta_\text{1} + cos \theta_\text{1}
\sqrt{1 - \frac{M^2_1}{M^2_2} sin^2 \theta_1} ~\Bigr) ,
\end{equation}

где \(\theta_1\) - угол вылета \emph{азота 15}, после соударения в лабороторной системе координат, а \(\theta_1\text{ц.м}\) - в системе центра масс.
\(M_1\) - масса налетающего иона. \( M_2\) - масса иона мишени.

Формула связывающая угол \(\theta_2\text{ц.м}\) и угол \(\theta_2\) для бора следующая

\begin{equation}\theta_2\text{ц.м} = \pi - 2\theta_2 ,\end{equation}

где \(\theta_2\) - угол вылета \emph{бора 11}, после соударения в лаборотрной системе координат, а \(\theta_2\text{ц.м}\) - в системе центра масс.


На рисунке \ref{res:graph} результат моделирования: выход \emph{азота 15} и \emph{бора 11} для различных углов. Так же на рисунке \ref{res:graph} изображено теоритическое сечение, на оснований которого разыгрывались соответсующие углы.

\end{document}
